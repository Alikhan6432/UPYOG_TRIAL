{"version":3,"sources":["../../src/utils/directMapping.js"],"names":["jp","require","externalHost","envVariables","EGOV_EXTERNAL_HOST","escapeRegex","string","replace","directMapping","req","dataconfig","variableTovalueMap","requestInfo","unregisteredLocalisationCodes","directArr","localisationCodes","localisationModules","variableToModuleMap","objectOfDirectMapping","query","map","jPath","item","variable","val","value","path","valJsonPath","type","url","format","localisation","uCaseNeeded","isUpperCaseRequired","i","length","toUpperCase","fun","Function","axios","get","responseType","response","headers","Buffer","from","data","toString","logger","error","stack","message","arrayOfOwnerObject","scema","j","ownerObject","k","fieldValue","myDate","Date","isNaN","replaceValue","required","loc","prefix","isCategoryRequired","isMainTypeRequired","isSubTypeRequired","delimiter","includes","push","module","currentValue","arrayOfBuiltUpDetails","isOrderedList","arrayOfItems","Array","isArray","p","orderedList","stringBuildpDetails","JSON","stringify","substring","code","localisationMap","resposnseMap","messages","Errors","Object","keys","forEach","key","index","indexOf","splice","objectKey","objectItemkey"],"mappings":"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","file":"directMapping.js","sourcesContent":["import get from \"lodash/get\";\nimport logger from \"../config/logger\";\nimport axios from \"axios\";\nimport envVariables from \"../EnvironmentVariables\";\nimport {\n  getLocalisationkey,\n  findLocalisation,\n  getDateInRequiredFormat,\n  getValue\n} from \"./commons\";\n\nvar jp = require(\"jsonpath\");\n\nlet externalHost = envVariables.EGOV_EXTERNAL_HOST;\n/**\n *\n * @param {*} req - current module object, picked from request body\n * @param {*} dataconfig  - data config\n * @param {*} variableTovalueMap - map used for filling values by template engine 'mustache'\n * @param {*} localisationMap - Map to store localisation key, value pair\n * @param {*} requestInfo - request info from request body\n */\n\nfunction escapeRegex(string) {\n  if(typeof string == \"string\")\n  return string.replace(/[\\\\\"]/g, '\\\\$&'); \n   else\n    return string;\n  }\n\nexport const directMapping = async (\n  req,\n  dataconfig,\n  variableTovalueMap,\n  requestInfo,\n  unregisteredLocalisationCodes\n) => {\n  var directArr = [];\n  var localisationCodes = [];\n  var localisationModules = [];\n  var variableToModuleMap = {};\n  // using jp-jsonpath because loadash can not handele '*'\n  var objectOfDirectMapping = jp.query(\n    dataconfig,\n    \"$.DataConfigs.mappings.*.mappings.*.direct.*\"\n  );\n  objectOfDirectMapping = getValue(\n    objectOfDirectMapping,\n    [],\n    \"$.DataConfigs.mappings.*.mappings.*.direct.*\"\n  );\n  directArr = objectOfDirectMapping.map(item => {\n    return {\n      jPath: item.variable,\n      val:\n        item.value &&\n        getValue(jp.query(req, item.value.path), \"NA\", item.value.path),\n      valJsonPath: item.value && item.value.path,\n      type: item.type,\n      url: item.url,\n      format: item.format,\n      localisation: item.localisation,\n      uCaseNeeded: item.isUpperCaseRequired\n    };\n  });\n\n  for (var i = 0; i < directArr.length; i++) {\n    //for array type direct mapping\n    if (directArr[i].type == \"citizen-employee-title\") {\n      if (get(requestInfo, \"userInfo.type\", \"NA\").toUpperCase() == \"EMPLOYEE\") {\n        variableTovalueMap[directArr[i].jPath] = \"Employee Copy\";\n      } else {\n        variableTovalueMap[directArr[i].jPath] = \"Citizen Copy\";\n      }\n    }\n    if (directArr[i].type == \"selectFromRequestInfo\") {\n      directArr[i].val = getValue(\n        jp.query(requestInfo, directArr[i].valJsonPath),\n        \"NA\",\n        directArr[i].valJsonPath\n      );\n\n      if (typeof directArr[i].val == \"object\" && directArr[i].val.length > 0)\n        directArr[i].val = directArr[i].val[0];\n\n      variableTovalueMap[directArr[i].jPath] = directArr[i].val;\n    } \n    else if (directArr[i].type == \"external_host\") {\n      variableTovalueMap[directArr[i].jPath] = externalHost;\n    }\n    else if (directArr[i].type == \"function\") {\n      var fun = Function(\"type\", directArr[i].format);\n      variableTovalueMap[directArr[i].jPath] = fun(directArr[i].val[0]);\n    } else if (directArr[i].type == \"image\") {\n      try {\n        var response = await axios.get(directArr[i].url, {\n          responseType: \"arraybuffer\"\n        });\n        variableTovalueMap[directArr[i].jPath] =\n          \"data:\" +\n          response.headers[\"content-type\"] +\n          \";base64,\" +\n          Buffer.from(response.data).toString(\"base64\");\n        //  logger.info(\"loaded image: \"+directArr[i].url);\n      } catch (error) {\n        logger.error(error.stack || error);\n        throw {\n          message: `error while loading image from: ${directArr[i].url}`\n        };\n      }\n    } else if (directArr[i].type == \"array\") {\n      let arrayOfOwnerObject = [];\n      // let ownerObject = JSON.parse(JSON.stringify(get(formatconfig, directArr[i].jPath + \"[0]\", [])));\n\n      let { format = {}, val = [], variable } = directArr[i];\n      let { scema = [] } = format;\n\n      //taking values about owner from request body\n      for (let j = 0; j < val.length; j++) {\n        // var x = 1;\n        let ownerObject = {};\n        for (let k = 0; k < scema.length; k++) {\n          let fieldValue = get(val[j], scema[k].value, \"NA\");\n          fieldValue = fieldValue == null ? \"NA\" : fieldValue;\n          if (scema[k].type == \"date\") {\n            let myDate = new Date(fieldValue);\n            if (isNaN(myDate) || fieldValue === 0) {\n              ownerObject[scema[k].variable] = \"NA\";\n            } else {\n              let replaceValue = getDateInRequiredFormat(fieldValue,scema[k].format);\n              // set(formatconfig,externalAPIArray[i].jPath[j].variable,replaceValue);\n              ownerObject[scema[k].variable] = replaceValue;\n            }\n          } else {\n            if (\n              fieldValue !== \"NA\" &&\n              scema[k].localisation &&\n              scema[k].localisation.required\n            ) {\n              let loc = scema[k].localisation;\n              fieldValue = await getLocalisationkey(\n                loc.prefix,\n                fieldValue,\n                loc.isCategoryRequired,\n                loc.isMainTypeRequired,\n                loc.isSubTypeRequired,\n                loc.delimiter\n              );\n              if(!localisationCodes.includes(fieldValue))\n                localisationCodes.push(fieldValue);\n\n              if(!localisationModules.includes(loc.module))\n                localisationModules.push(loc.module);\n\n              variableToModuleMap[scema[k].variable] = loc.module;\n            }\n            let currentValue = fieldValue;\n            if (typeof currentValue == \"object\" && currentValue.length > 0)\n              currentValue = currentValue[0];\n\n            currentValue= escapeRegex(currentValue);\n            ownerObject[scema[k].variable] = currentValue;\n          }\n          // set(ownerObject[x], \"text\", get(val[j], scema[k].key, \"\"));\n          // x += 2;\n        }\n        arrayOfOwnerObject.push(ownerObject);\n      }\n      // set(formatconfig, directArr[i].jPath, arrayOfOwnerObject);\n      variableTovalueMap[directArr[i].jPath] = arrayOfOwnerObject;\n    }\n\n    //setting value in pdf for array-column type direct mapping\n    else if (directArr[i].type == \"array-column\") {\n      let arrayOfBuiltUpDetails = [];\n      let isOrderedList = false;\n      // let arrayOfFields=get(formatconfig, directArr[i].jPath+\"[0]\",[]);\n      // arrayOfBuiltUpDetails.push(arrayOfFields);\n\n      let { format = {}, val = [], variable } = directArr[i];\n      let { scema = [] } = format;\n      //to get data of multiple floor Built up details\n      for (let j = 0; j < val.length; j++) {\n        let arrayOfItems = [];\n        for (let k = 0; k < scema.length; k++) {\n          let fieldValue = get(val[j], scema[k].value, \"NA\");\n          fieldValue = fieldValue == null ? \"NA\" : fieldValue;\n          if (scema[k].type == \"date\") {\n            let myDate = new Date(fieldValue);\n            if (isNaN(myDate) || fieldValue === 0) {\n              arrayOfItems.push(\"NA\");\n            } else {\n              let replaceValue = getDateInRequiredFormat(fieldValue,scema[k].format);\n              // set(formatconfig,externalAPIArray[i].jPath[j].variable,replaceValue);\n              arrayOfItems.push(replaceValue);\n            }\n          } \n          /**\n           * This condition is for displaying the ordered list data \n           * when data is coming as array of strings instead of key value pair.\n           * Provided new scema type (array-orderedlist) which we should mention at data-config\n           * to display the array of string in order list.\n           */\n          else if (scema[k].type == \"array-orderedlist\" && Array.isArray(fieldValue)) {\n            if(fieldValue !== \"NA\") {\n              for (var p = 0; p < fieldValue.length; p++) {\n                let orderedList = [];\n                orderedList.push(fieldValue[p]);\n                arrayOfBuiltUpDetails.push(orderedList);\n              }\n              isOrderedList = true;\n            }\n          } else {\n            if (\n              fieldValue !== \"NA\" &&\n              scema[k].localisation &&\n              scema[k].localisation.required\n            ) {\n              let loc = scema[k].localisation;\n              fieldValue = await getLocalisationkey(\n                loc.prefix,\n                fieldValue,\n                loc.isCategoryRequired,\n                loc.isMainTypeRequired,\n                loc.isSubTypeRequired,\n                loc.delimiter\n              );\n              if(!localisationCodes.includes(fieldValue))\n                localisationCodes.push(fieldValue);\n\n              if(!localisationModules.includes(loc.module))\n                localisationModules.push(loc.module);\n            }\n            arrayOfItems.push(fieldValue);\n          }\n        }\n        if(isOrderedList === false)\n          arrayOfBuiltUpDetails.push(arrayOfItems);\n      }\n\n      // remove enclosing [ &  ]\n      let stringBuildpDetails = JSON.stringify(arrayOfBuiltUpDetails).replace(\n        \"[\",\n        \"\"\n      );\n      stringBuildpDetails = stringBuildpDetails.substring(\n        0,\n        stringBuildpDetails.length - 1\n      );\n\n      variableTovalueMap[directArr[i].jPath] = stringBuildpDetails;\n      // set(formatconfig,directArr[i].jPath,arrayOfBuiltUpDetails);\n    }\n    //setting value in pdf for no type direct mapping\n    else if (directArr[i].type == \"label\") {\n      let code = await getLocalisationkey(\n        directArr[i].localisation.prefix,\n        directArr[i].valJsonPath,\n        directArr[i].localisation.isCategoryRequired,\n        directArr[i].localisation.isMainTypeRequired,\n        directArr[i].localisation.isSubTypeRequired,\n        directArr[i].localisation.delimiter\n      );\n      if(!localisationCodes.includes(code))\n        localisationCodes.push(code);\n\n      if(!localisationModules.includes(directArr[i].localisation.module))\n        localisationModules.push(directArr[i].localisation.module);\n\n      variableTovalueMap[directArr[i].jPath] = code;\n      variableToModuleMap[directArr[i].jPath] = directArr[i].localisation.module;\n\n    } \n    \n    else if (directArr[i].type == \"date\") {\n      let myDate = new Date(directArr[i].val[0]);\n      if (isNaN(myDate) || directArr[i].val[0] === 0) {\n        variableTovalueMap[directArr[i].jPath] = \"NA\";\n      } else {\n        let replaceValue = getDateInRequiredFormat(directArr[i].val[0],directArr[i].format);\n        variableTovalueMap[directArr[i].jPath] = replaceValue;\n      }\n    } \n\n    else {\n      directArr[i].val = getValue(\n        directArr[i].val,\n        \"NA\",\n        directArr[i].valJsonPath\n      );\n      if (\n        directArr[i].val !== \"NA\" &&\n        directArr[i].localisation &&\n        directArr[i].localisation.required\n      ){\n\n        let code = await getLocalisationkey(\n          directArr[i].localisation.prefix,\n          directArr[i].val,\n          directArr[i].localisation.isCategoryRequired,\n          directArr[i].localisation.isMainTypeRequired,\n          directArr[i].localisation.isSubTypeRequired,\n          directArr[i].localisation.delimiter\n        );\n\n        if (typeof code == \"object\" && code.length > 0)\n          code = code[0];\n\n        if(!localisationCodes.includes(code))\n          localisationCodes.push(code);\n\n        if(!localisationModules.includes(directArr[i].localisation.module))\n          localisationModules.push(directArr[i].localisation.module);\n\n        variableTovalueMap[directArr[i].jPath] = code;\n\n        variableToModuleMap[directArr[i].jPath] = directArr[i].localisation.module;\n\n      }\n        \n      else{\n        let currentValue = directArr[i].val;\n          if (typeof currentValue == \"object\" && currentValue.length > 0)\n            currentValue = currentValue[0];\n          \n         // currentValue=currentValue.replace(/\\\\/g,\"\\\\\\\\\").replace(/\"/g,'\\\\\"');\n        currentValue= escapeRegex(currentValue);\n        variableTovalueMap[directArr[i].jPath] = currentValue;\n      } \n      if (directArr[i].uCaseNeeded) {\n        let currentValue = variableTovalueMap[directArr[i].jPath];\n        if (typeof currentValue == \"object\" && currentValue.length > 0)\n          currentValue = currentValue[0];\n        variableTovalueMap[directArr[i].jPath] = currentValue.toUpperCase();\n      }\n    }\n  }\n\n  let localisationMap = [];\n  try{\n    let resposnseMap = await findLocalisation(\n      requestInfo,\n      localisationModules,\n      localisationCodes\n    );\n  \n    resposnseMap.messages.map((item) => {\n      localisationMap[item.code + \"_\" + item.module] = item.message;\n    });\n  }\n  catch (error) {\n    logger.error(error.stack || error);\n    throw{\n      message: `Error in localisation service call: ${error.Errors[0].message}`\n    }; \n  }\n\n  \n  \n\n  Object.keys(variableTovalueMap).forEach(function(key) {\n    if(variableToModuleMap[key] && typeof variableTovalueMap[key] == 'string'){\n      var code = variableTovalueMap[key];\n      var module = variableToModuleMap[key];\n      if(localisationMap[code+\"_\"+module]){\n        variableTovalueMap[key] = localisationMap[code+\"_\"+module];\n        if(unregisteredLocalisationCodes.includes(code)){\n          var index = unregisteredLocalisationCodes.indexOf(code);\n          unregisteredLocalisationCodes.splice(index, 1);\n        }\n      }\n      else{\n        if(!unregisteredLocalisationCodes.includes(code))\n          unregisteredLocalisationCodes.push(code);\n      }\n    }\n\n    if(typeof variableTovalueMap[key] =='object'){\n      Object.keys(variableTovalueMap[key]).forEach(function(objectKey){\n        Object.keys(variableTovalueMap[key][objectKey]).forEach(function(objectItemkey) {\n          if(variableToModuleMap[objectItemkey]){\n            var module = variableToModuleMap[objectItemkey];\n            var code = variableTovalueMap[key][objectKey][objectItemkey];\n            if(localisationMap[code+\"_\"+module]){\n              variableTovalueMap[key][objectKey][objectItemkey] = localisationMap[code+\"_\"+module];\n              if(unregisteredLocalisationCodes.includes(code)){\n                var index = unregisteredLocalisationCodes.indexOf(code);\n                unregisteredLocalisationCodes.splice(index, 1);\n              }\n            }\n            else{\n              if(!unregisteredLocalisationCodes.includes(code))\n                unregisteredLocalisationCodes.push(code);\n            }\n          }\n        });\n      });    \n    }\n\n  });\n  \n};\n"]}